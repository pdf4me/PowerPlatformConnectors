{
  "properties": {
    "iconBrandColor": "#000000",
    "capabilities": [],
    "publisher": "Riverbed Technology",
    "stackOwner": "Riverbed Technology",
    "connectionParameters": {
      "token": {
        "type": "oauthSetting",
        "oAuthSettings": {
          "identityProvider": "aad",
          "clientId": "",
          "scopes": [],
          "redirectMode": "GlobalPerConnector",
          "redirectUrl": "https://global.consent.azure-apim.net/redirect",
          "properties": {
            "IsFirstParty": "False",
            "AzureActiveDirectoryResourceId": "",
            "IsOnbehalfofLoginSupported": false
          },
          "customParameters": {
            "LoginUri": {
              "value": "https://login.microsoftonline.com"
            },
            "TenantId": {
              "value": "common"
            },
            "EnableOnbehalfOfLogin": {
              "value": "false"
            },
            "ResourceUri": {
              "value": ""
            }
          }
        },
        "uiDefinition": {
          "displayName": "OAuth Connection",
          "description": "OAuth Connection",
          "constraints": {
            "required": "true",
            "hidden": "false"
          }
        }
      },
      "token:TenantId": {
        "type": "string",
        "metadata": {
          "sourceType": "AzureActiveDirectoryTenant"
        },
        "uiDefinition": {
          "displayName": "Entra ID Directory Tenant ID",
          "constraints": {
            "required": "false",
            "hidden": "true"
          }
        }
      }
    },
    "connectionParameterSets": {
      "uiDefinition": {
        "displayName": "Connector Type",
        "description": "Type of authentication to be used."
      },
      "values": [
        {
          "name": "oAuthClientCredentials",
          "uiDefinition": {
            "displayName": "Riverbed IQ OAuth Client",
            "description": "Riverbed IQ OAuth Client"
          },
          "parameters": {
            "token": {
              "type": "oauthSetting",
              "oAuthSettings": {
                "identityProvider": "aad",
                "clientId": "{clientId}",
                "scopes": [
                  "{Scope}"
                ],
                "redirectMode": "GlobalPerConnector",
                "redirectUrl": "https://global.consent.azure-apim.net/redirect",
                "properties": {
                  "IsFirstParty": "False",
                  "AzureActiveDirectoryResourceId": "{ResourceUri}",
                  "IsOnbehalfofLoginSupported": true
                },
                "customParameters": {
                  "grantType": {
                    "value": "client_credentials"
                  },
                  "LoginUri": {
                    "value": "https://login.microsoftonline.com"
                  },
                  "TenantId": {
                    "value": "common"
                  },
                  "EnableOnbehalfOfLogin": {
                    "value": "false"
                  },
                  "ResourceUri": {
                    "value": "{ResourceUri}"
                  }
                }
              },
              "uiDefinition": {
                "displayName": "Service Principal Connection",
                "description": "Service Principal Connection",
                "constraints": {
                  "required": "false",
                  "hidden": "true"
                }
              }
            },
            "token:clientId": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Client ID",
                "schema": {
                  "type": "string",
                  "description": "Example: 456879-456-1231"
                },
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            },
            "token:clientSecret": {
              "type": "securestring",
              "uiDefinition": {
                "displayName": "Client Secret",
                "schema": {
                  "type": "securestring",
                  "description": "Example: *******"
                },
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            },
            "token:tokenUrl": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Token URL",
                "schema": {
                  "type": "string",
                  "description": "Example: https://login.microsoftonline.com/999-9999-999/oauth2/v2.0/token"
                },
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            },
            "token:Scope": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Scope",
                "schema": {
                  "type": "string",
                  "description": "Example api://111-1111-111/.default"
                },
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            },
            "token:TenantId": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Entra ID Directory Tenant ID",
                "schema": {
                  "type": "string",
                  "description": "Example: 999-9999-999 (see tenant_id in https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token)"
                },
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            },
            "token:ResourceUri": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Resource Uri",
                "schema": {
                  "type": "string",
                  "description": "Example: api://111-1111-111 (see Scope and remove ending \"/.default\")"
                },
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            },
            "tenantName": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Tenant Name",
                "description": "Tenant Name",
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            },
            "tenantId": {
              "type": "string",
              "uiDefinition": {
                "displayName": "Tenant Id",
                "description": "Tenant Id",
                "constraints": {
                  "required": "true",
                  "hidden": "false"
                }
              }
            }
          },
          "metadata": {
            "allowSharing": true
          }
        }
      ]
    },
    "policyTemplateInstances": [
      {
        "templateId": "dynamichosturl",
        "title": "Compose Riverbed IQ API base URL",
        "parameters": {
          "x-ms-apimTemplateParameter.urlTemplate": "https://@connectionParameters('tenantName').app.cloud.riverbed.com/api/skills/1.0/tenants/@connectionParameters('tenantId')"
        }
      }
    ]
  }
}
